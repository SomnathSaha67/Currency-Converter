<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Currency Converter</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,700,900|Montserrat:700&display=swap">
  <link rel="icon" href="/static/favicon.svg" type="image/svg+xml">
  <meta name="theme-color" content="#12223b">
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="app-root">
    <header class="site-header" role="banner">
      <div class="brand">
        <h1 class="brand-title">Currency Converter</h1>
        <p class="brand-sub">Minimal • Instant • Fullscreen</p>
      </div>
      <div class="header-actions">
        <button id="themeToggleBtn" class="theme-btn" title="Toggle Dark/Light" aria-label="Toggle theme">
          <span id="themeToggleIcon">
            <svg width="26" height="26" viewBox="0 0 29 29" fill="none" xmlns="http://www.w3.org/2000/svg" id="sunIcon">
              <circle cx="14.5" cy="14.5" r="6.5" stroke="#fff" stroke-width="2" fill="#ffe965"/>
            </svg>
            <svg width="26" height="26" viewBox="0 0 29 29" fill="none" xmlns="http://www.w3.org/2000/svg" id="moonIcon" style="display: none;">
              <path d="M21.6 18.6A8 8 0 1 1 14.1 6.2a7 7 0 1 0 7.5 12.4z" fill="#acd8fa" stroke="#fff" stroke-width="2"/>
            </svg>
          </span>
        </button>
      </div>
    </header>

    <main class="app-grid" role="main">
      <!-- Converter form/results (top row, full width) -->
      <form id="convertForm" class="converter" autocomplete="off" onsubmit="return false;">
        <div class="input-row glass-input">
          <input id="amount" type="number" value="1" min="1" step="any" required aria-label="Amount" placeholder="Amount" />
          <select id="from" aria-label="From currency"></select>
          <button type="button" class="swap-btn" id="swapBtn" title="Swap">⇆</button>
          <select id="to" aria-label="To currency"></select>
        </div>
        <div class="input-row">
          <input id="date" type="date" aria-label="Conversion date" placeholder="Date (optional)" />
          <button id="convertBtn" class="primary-btn">Convert</button>
        </div>
        <div id="errorArea" aria-live="assertive"></div>
      </form>

      <section id="resultBox" role="status" aria-atomic="true">
        <div class="result" id="resultArea" aria-live="polite"></div>
        <div class="meta" id="metaArea"></div>
      </section>

      <!-- Fee simulation (only meaningful when a single pair is selected) -->
      <section class="fee-section" aria-label="Fee simulator">
        <h2 class="fee-title">Fee Simulator</h2>
        <p class="fee-desc">
          Add a flat fee and/or a percentage fee to see how much you actually receive after fees.
        </p>
        <div class="fee-inputs">
          <input
            id="feeFlat"
            type="number"
            min="0"
            step="any"
            placeholder="Flat fee in source currency"
            aria-label="Flat fee in source currency"
          />
          <input
            id="feePercent"
            type="number"
            min="0"
            step="any"
            placeholder="Fee % on source amount"
            aria-label="Percentage fee on source amount"
          />
          <button type="button" id="feeCalcBtn" class="primary-btn fee-btn">
            Apply fees
          </button>
          <button type="button" id="feeResetBtn" class="fee-reset-btn">
            Reset
          </button>
        </div>
        <div id="feeResult" class="fee-result" aria-live="polite">
          Run a conversion first, then add your bank or platform fees to simulate the net amount.
        </div>
      </section>

      <!-- Smart rate alert banner -->
      <div id="alertBanner" aria-live="polite" role="status" aria-atomic="true"></div>

      <section id="providerBox">
        <div id="providerArea"></div>
      </section>

      <!-- Left column: Scenario Planner -->
      <section class="scenario-section" aria-label="Scenario planner">
        <h2 class="scenario-title">What if the rate changes?</h2>
        <p id="scenarioHeader">
          Scenario planner will appear when a valid live rate is available.
        </p>
        <table class="scenario-table">
          <thead>
            <tr>
              <th>Rate move</th>
              <th>New rate</th>
              <th>Converted amount</th>
              <th>Difference vs now</th>
            </tr>
          </thead>
          <tbody id="scenarioBody">
          </tbody>
        </table>
      </section>

      <!-- Left column: Trip Budget Helper -->
      <section class="trip-section" aria-label="Trip budget helper">
        <h2 class="trip-title">Trip Budget Helper</h2>
        <p class="trip-desc">
          Plan a trip by converting your total budget into the destination currency and seeing a suggested daily budget.
        </p>
        <div class="trip-inputs">
          <input
            id="tripBudget"
            type="number"
            min="0"
            step="any"
            placeholder="Trip budget in home currency"
            aria-label="Trip budget in home currency"
          />
          <input
            id="tripDays"
            type="number"
            min="1"
            step="1"
            placeholder="Number of days"
            aria-label="Number of trip days"
          />
          <button type="button" id="tripCalcBtn" class="primary-btn trip-btn">
            Calculate trip budget
          </button>
        </div>
        <div id="tripResult" class="trip-result" aria-live="polite"></div>
      </section>

      <!-- Side column (right on desktop, bottom on mobile) -->
      <aside class="side-column" aria-label="Controls and extras">
        <section class="favorites-section" aria-label="Favorite currency pairs">
        <h2 class="favorites-title">Favorite Pairs</h2>
        <p style="margin:0 0 0.4em 0;font-size:0.96rem;color:var(--text-secondary);">
          Pin your most-used pairs for one-click access.
        </p>
        <button type="button" id="addFavoriteBtn" class="primary-btn" style="padding:0.5em 1.1em;font-size:0.95rem;margin-bottom:0.6em;">
          Add current pair to favorites
        </button>
        <div id="favoritesList" class="favorites-row"></div>
      </section>

      <!-- Right column: Rate alert -->
      <section class="alert-section" aria-label="Rate alerts">
        <h2 class="alert-title">Smart Rate Alert</h2>
        <p style="margin:0 0 0.4em 0;font-size:0.96rem;color:var(--text-secondary);">
          Set a target rate for the selected pair. When the live rate crosses your target, a banner will highlight it.
        </p>
        <div class="alert-controls">
          <span>Alert when rate</span>
          <select id="alertDirection" aria-label="Alert direction">
            <option value="below">falls to or below</option>
            <option value="above">rises to or above</option>
          </select>
          <input id="alertRate" type="number" step="any" min="0" placeholder="Target rate" aria-label="Target rate" />
          <button type="button" id="saveAlertBtn" class="primary-btn" style="padding:0.5em 1.1em;font-size:0.95rem;">
            Save alert
          </button>
        </div>
        <div id="alertSummary" class="alert-summary"></div>
      </section>

      <!-- Right column: Financial Tips -->
      <section id="tipBlock" class="tip-section">
        <h2 class="tip-title">Financial Tip</h2>
        <div id="financialTip"></div>
      </section>

      <!-- Right column: Indices Ticker Widget -->
      <section id="tvBlock" class="tv-section">
        <h2 class="tv-title">Global Market Indices</h2>
        <div id="tradingview-widget"></div>
        </section>
      </aside>
    </main>

    <footer class="site-footer">
      <div>Built by Somnath Saha • Minimal design, 2025</div>
      <div class="footer-right">Tip: press <kbd>Ctrl</kbd>+<kbd>Enter</kbd> to convert • <kbd>S</kbd> to swap</div>
    </footer>
  </div>
  <script src="/static/main.js"></script>
  <script>
    function setTheme(mode) {
      document.documentElement.setAttribute('data-theme', mode);
      localStorage.setItem('theme', mode);
      if (mode === 'light') {
        document.getElementById("sunIcon").style.display = "none";
        document.getElementById("moonIcon").style.display = "";
      } else {
        document.getElementById("sunIcon").style.display = "";
        document.getElementById("moonIcon").style.display = "none";
      }
    }
    function toggleTheme() {
      const current = localStorage.getItem('theme') || 'dark';
      const next = current === 'light' ? 'dark' : 'light';
      setTheme(next);
    }
    document.addEventListener('DOMContentLoaded', () => {
      const saved = localStorage.getItem('theme') || 'dark';
      setTheme(saved);
      const toggleBtn = document.getElementById('themeToggleBtn');
      if (toggleBtn) toggleBtn.addEventListener('click', () => {
        // small rotate animation
        toggleBtn.animate([{transform:'rotate(0deg)'},{transform:'rotate(360deg)'}],{duration:420,fill:'forwards'});
        toggleTheme();
      });
    });
  </script>
</body>
</html>
